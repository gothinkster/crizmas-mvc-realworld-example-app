(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{28:function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"h",(function(){return i})),a.d(t,"i",(function(){return l})),a.d(t,"g",(function(){return m})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"k",(function(){return f})),a.d(t,"m",(function(){return h})),a.d(t,"l",(function(){return b})),a.d(t,"d",(function(){return p})),a.d(t,"a",(function(){return g})),a.d(t,"j",(function(){return v})),a.d(t,"b",(function(){return E}));var n=a(3),r=a(4);const o=e=>{e.createdAt=new Date(e.createdAt),e.updatedAt=new Date(e.updatedAt)},c=e=>(e.articles.forEach(o),e),s=({offset:e,limit:t})=>Object(n.b)("articles",{offset:e,limit:t}).then(r.b).then(c),i=({offset:e,limit:t})=>Object(n.b)("articles/feed",{offset:e,limit:t}).then(r.b).then(c),l=({tag:e,offset:t,limit:a})=>Object(n.b)("articles",{tag:e,offset:t,limit:a}).then(r.b).then(c),m=({author:e,limit:t,offset:a})=>Object(n.b)("articles",{author:e,offset:a,limit:t}).then(r.b).then(c),u=({favorited:e,limit:t,offset:a})=>Object(n.b)("articles",{favorited:e,offset:a,limit:t}).then(r.b).then(c),d=({slug:e})=>Object(n.b)(`articles/${encodeURIComponent(e)}`).then(r.b).then(({article:e})=>(o(e),{article:e})),f=({title:e,description:t,body:a,tagList:o})=>Object(n.c)("articles",{article:{title:e,description:t,body:a,tagList:o}}).then(r.b,r.a),h=({slug:e,title:t,description:a,body:o,tagList:c})=>Object(n.d)(`articles/${encodeURIComponent(e)}`,{article:{title:t,description:a,body:o,tagList:c}}).then(r.b,r.a),b=({slug:e,isFavorite:t})=>{return(t?n.c:n.a)(`articles/${e}/favorite`).then(r.b)},p=({slug:e})=>Object(n.b)(`articles/${encodeURIComponent(e)}/comments`).then(r.b).then(({comments:e})=>(e.forEach(o),{comments:e})),g=({slug:e})=>Object(n.a)(`articles/${encodeURIComponent(e)}`),v=({slug:e,comment:t})=>Object(n.c)(`articles/${encodeURIComponent(e)}/comments`,{comment:{body:t}}).then(r.b).then(({comment:e})=>(o(e),{comment:e})),E=({slug:e,commentId:t})=>Object(n.a)(`articles/${encodeURIComponent(e)}/comments/${t}`)},29:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1);function r(e){const t={title:e.title,author:new n.a(e.author),description:e.description,body:e.body,slug:e.slug,createdAt:e.createdAt,updatedAt:e.updatedAt,favorited:e.favorited,favoritesCount:e.favoritesCount,tagList:e.tagList,comments:null,setFavorite:({favorited:e,favoritesCount:a})=>{t.favorited=e,t.favoritesCount=a},setComments:e=>{t.comments=e},addComment:e=>{t.comments.unshift(e)},deleteComment:e=>{const a=t.comments.findIndex(t=>t.id===e);-1!==a&&t.comments.splice(a,1)}};return t}},30:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const n=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}),r=e=>n.format(e)},31:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(8),c=a.n(o),s=a(2),i=a(30);const l=({article:e})=>r.a.createElement("span",null,r.a.createElement(s.Link,{to:`/@${encodeURIComponent(e.author.username)}`},r.a.createElement("img",{src:e.author.image})," "),r.a.createElement("div",{className:"info"},r.a.createElement(s.Link,{to:`/@${encodeURIComponent(e.author.username)}`,className:"author"},e.author.username),r.a.createElement("span",{className:"date"},Object(i.a)(e.createdAt))));l.propTypes={article:c.a.object.isRequired},t.a=l},32:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(8);const c=({article:e})=>!!e.tagList.length&&r.a.createElement("ul",{className:"tag-list"},e.tagList.map((e,t)=>r.a.createElement("li",{key:t,className:"tag-default tag-pill tag-outline"},e)));c.propTypes={article:a.n(o).a.object.isRequired},t.a=c},33:function(e,t,a){"use strict";var n=a(5),r=a.n(n),o=a(1),c=a(28),s=a(9);t.a=r.a.controller({setFavorite:e=>o.b.isAuthenticated?c.l({slug:e.slug,isFavorite:!e.favorited}).then(t=>{e.setFavorite(t.article)}):(s.a.transitionTo("/register"),Promise.reject(new Error("The user is not authenticated")))})},70:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return p}));var n=a(0),r=a.n(n),o=a(8),c=a.n(o),s=a(2),i=a(34),l=a(51),m=a(27),u=a.n(m),d=a(31),f=a(32),h=a(30);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}class p extends n.Component{constructor(){super(),this.onDelete=()=>{this.props.controller.deleteArticle()},this.setFollowing=()=>{this.props.controller.setFollowing()},this.setFavorite=()=>{this.props.controller.setFavorite()},this.onSubmit=e=>{e.preventDefault(),this.props.controller.form.submit()}}renderArticleMeta(){const{article:e,currentUser:t,pending:a}=this.props.controller;return r.a.createElement("div",{className:"article-meta"},r.a.createElement(d.a,{article:e}),e.author.username===t.username&&r.a.createElement("span",null,r.a.createElement(s.Link,{to:`/editor/${e.slug}`,className:"btn btn-sm btn-outline-secondary"},r.a.createElement("i",{className:"ion-edit"}),"  Edit Article")," ",r.a.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:this.onDelete,disabled:a.has("deleteArticle")},r.a.createElement("i",{className:"ion-trash-a"}),"  Delete Article")),e.author.username!==t.username&&r.a.createElement("span",null,r.a.createElement("button",{className:u()("btn btn-sm",{"btn-secondary":e.author.following,"btn-outline-secondary":!e.author.following}),onClick:this.setFollowing,disabled:a.has("setFollowing")},r.a.createElement("i",{className:"ion-plus-round"})," ",e.author.following?"Unfollow":"Follow"," ",e.author.username)," ",r.a.createElement("button",{className:u()("btn btn-sm",{"btn-primary":e.favorited,"btn-outline-primary":!e.favorited}),onClick:this.setFavorite,disabled:a.has("setFavorite")},r.a.createElement("i",{className:"ion-heart"})," ",e.favorited?"Unfavorite Article":"Favorite Article","(",e.favoritesCount,")")))}render(){const{article:e,article:{comments:t},currentUser:a,form:n,deleteComment:o}=this.props.controller;return r.a.createElement("div",{className:"article-page"},r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,e.title),this.renderArticleMeta())),r.a.createElement("div",{className:"container page"},r.a.createElement("div",{className:"row article-content"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:l.markdown.toHTML(e.body)}}),r.a.createElement(f.a,{article:e}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"article-actions"},this.renderArticleMeta()),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-xs-12 col-md-8 offset-md-2"},r.a.createElement("form",{className:"card comment-form",onSubmit:this.onSubmit},r.a.createElement("div",{className:"card-block"},r.a.createElement(i.Input,b({type:"textarea",inputClassName:"form-control",placeholder:"Write a comment...",inputProps:{rows:"3"}},n))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("img",{src:a.image,className:"comment-author-img"}),r.a.createElement("button",{className:"btn btn-sm btn-primary"},"Post Comment"))),t&&!!t.length&&t.map((e,t)=>r.a.createElement("div",{key:t,className:"card"},r.a.createElement("div",{className:"card-block"},r.a.createElement("p",{className:"card-text"},e.body)),r.a.createElement("div",{className:"card-footer"},r.a.createElement(s.Link,{to:`/@${encodeURIComponent(e.author.username)}`,className:"comment-author"},r.a.createElement("img",{src:e.author.image,className:"comment-author-img"})),"  ",r.a.createElement(s.Link,{to:`/@${encodeURIComponent(e.author.username)}`,className:"comment-author"},e.author.username),r.a.createElement("span",{className:"date-posted"},Object(h.a)(e.createdAt)),e.author.username===a.username&&r.a.createElement("span",{className:"mod-options"},r.a.createElement("i",{className:"ion-trash-a",onClick:o.bind(null,e.id)})))))))))}}p.propTypes={controller:c.a.object.isRequired}},71:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),o=a(10),c=a.n(o),s=a(28),i=a(1),l=a(29),m=a(9),u=a(11),d=a(33);t.default=r.a.controller((function(){const e={article:null,currentUser:i.b,form:null,onEnter:()=>{const a=m.a.params.get("slug"),n=e.getArticle(a);return n.then(()=>{e.getComments(a)}),n.then(t,()=>(m.a.transitionTo("/"),!1))}},t=()=>{e.form=new c.a({actions:{submit:()=>{e.postComment(e.form.getResult())}}})};return e.getArticle=t=>s.c({slug:t}).then(({article:t})=>{e.article=new l.a(t)}),e.getComments=t=>s.d({slug:t}).then(({comments:t})=>{e.article.setComments(t)}),e.deleteArticle=()=>s.a({slug:e.article.slug}).then(()=>{m.a.transitionTo("/")}),e.setFollowing=()=>u.a.setFollowing(e.article.author),e.setFavorite=()=>d.a.setFavorite(e.article),e.postComment=t=>i.b.isAuthenticated?s.j({slug:e.article.slug,comment:t}).then(({comment:t})=>{e.article.addComment(t),e.form.clear()}):m.a.transitionTo("/register"),e.deleteComment=t=>s.b({slug:e.article.slug,commentId:t}).then(()=>{e.article.deleteComment(t)}),e}))}}]);
//# sourceMappingURL=article.bundle-bd4141efc910f27bfc0e.js.map